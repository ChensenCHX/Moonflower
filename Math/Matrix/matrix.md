# 矩阵乘法

## 一：矩阵乘法定义：

### A[n,m]*B[m,z]=C[n,z],结果是C的第n行z列的数等于A第n行的每一个数与对应B第z列的数相乘的和

## 二：定义矩阵运算式：

### 1：抽象出一个n行1列的矩阵，来作为状态矩阵，其中首个单位即为所求量。

### 2：再定义下一阶矩阵，通过递推关系来得出转移矩阵。

### 3：最后通过快速幂转移矩阵，再与状态矩阵相乘快速得到答案

## 三：要点

### 抽象的n维向量单位时间只变化一次，且只是若干加法或乘以某一系数的运算

### 向量变化时间很长，但本身长度不变

## 四：例如：

###  例1----

### Alice和Bob想吃爆米花，可是他们没有爆米花桶，想叠一个n层的爆米花桶，但是他们不知道叠一个n层的桶需要多大的纸，他们来请教你。f[i]为叠一个i层的爆米花桶需要的纸的面积，叠一层时需要面积为a的纸，叠两层需要面积为b的纸，叠i层需要面积为f[i]=f[i-1]+f[i+1]的纸，请你告诉他们叠一个n层的爆米花桶需要多大面积的纸壳，并对1e9+7取模

### 先求出fn的递推关系式,fn=f(n-1)-f(n-2)

### 由此，最基础的状态方程 $$\begin{bmatrix}a3\\a2\\a1\\\end{bmatrix}$$

### 下一届状态方程为  $$\begin{bmatrix}a4\\a3\\a2\\\end{bmatrix}$$

### 可知a4=a3-a3,a3=a3,a2=a2.构建转移矩阵（n*n）大小，第i行表示第i个数的转移方程 $$\begin{bmatrix}1&-1&0\\1&0&0\\0&1&0\\\end{bmatrix}$$  剩下就是些基础运算

###  例2----

石头游戏在一个 n 行 m 列的网格上进行，每个格子对应一种操作序列，操作序列至多有 10 种，分别用 0∼9 这 10 个数字指明。

操作序列是一个长度不超过 6 且循环执行、每秒执行一个字符的字符串。

每秒钟，所有格子同时执行各自操作序列里的下一个字符。

序列中的每个字符是以下格式之一：

1：数字 0∼9：表示拿 0∼9 个石头到该格子。

2：NWSE：表示把这个格子内所有的石头推到相邻的格子，N 表示上方，W 表示左方，S 表示下方，E 表示右方。

3：D：表示拿走这个格子的所有石头。
给定每种操作序列对应的字符串，以及网格中每个格子对应的操作序列，求石头游戏进行了 t 秒之后，石头最多的格子里有多少个石头。

在游戏开始时，网格是空的。

### 分析：
### 1；符合矩阵乘法的首要条件，每一次只进行一次简单改变。考虑用状态矩阵表示每一个点的石子数，跟据实际情况将n*m的数组抽象成一个一维矩阵id=(x-1)*m+y。相应，转移方程为一个（n*m，n*m）的矩阵，（i，j）表示第i个数向第j的转移状态。

### 以0点作为所有的石子来源点，i 取石子就是（i，0）=x
### i 转移到 j 就是（ j , i ）=1,( i , i)=0
### 其余同理，注意状态方程的b0始终为1，因为它是假定的所有石子的源泉，转移方程（i，i）如果不是要取走i的石子则为1

### 2:1-6的最大公约数不超过60，所以计算出60秒内每一秒的转移方程，算出一周期的总变化，再快速幂